<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>é€™æ¨£å¯« Code å¥½ä¸å¥½ ?</title>
    <url>/blog.github.io/2024/11/18/Is-it-OK-to-code-like-this/</url>
    <content><![CDATA[<h3 id="å–®å…ƒç¸½è¦½"><a href="#å–®å…ƒç¸½è¦½" class="headerlink" title="å–®å…ƒç¸½è¦½"></a>å–®å…ƒç¸½è¦½</h3><ul>
<li>é¡åˆ¥è¨­è¨ˆ &#x2F; ä¸å¯è®Šæ€§è³ª<ul>
<li><a href="#%E7%A9%A9%E5%9B%BA%E7%9A%84%E9%A1%9E%E5%88%A5%E8%A8%AD%E8%A8%88">ç©©å›ºçš„é¡åˆ¥è¨­è¨ˆ</a></li>
<li><a href="#%E5%80%BC%E7%89%A9%E4%BB%B6">å€¼ç‰©ä»¶</a></li>
</ul>
</li>
<li>ä½å…§èš<ul>
<li><a href="#%E6%9C%80%E5%B0%91%E7%9F%A5%E8%AD%98%E5%8E%9F%E5%89%87">æœ€å°‘çŸ¥è­˜åŸå‰‡</a></li>
<li><a href="#%E8%AA%A4%E7%94%A8%E7%9A%84%E5%85%B1%E7%94%A8%E9%A1%9E%E5%88%A5">èª¤ç”¨çš„ Utility &#x2F;Common é¡åˆ¥</a></li>
<li>[åˆ†æ•£çš„åˆå§‹åŒ–å‡½å¼]ï¼ˆï¼‰</li>
</ul>
</li>
</ul>
<h3 id="ç©©å›ºçš„é¡åˆ¥è¨­è¨ˆ"><a href="#ç©©å›ºçš„é¡åˆ¥è¨­è¨ˆ" class="headerlink" title="ç©©å›ºçš„é¡åˆ¥è¨­è¨ˆ"></a>ç©©å›ºçš„é¡åˆ¥è¨­è¨ˆ</h3><p>éåº¦å½ˆæ€§çš„é¡åˆ¥åœ¨ç°¡æ˜“çš„ç³»çµ±ä¸­ä¸æ˜¯å•é¡Œï¼Œåœ¨ç¶“å¹´ç´¯æœˆçš„ç³»çµ±ä¸­å»æ˜¯é€ æˆä¸ç©©å®šçš„éš±å½¢æ®ºæ‰‹ï¼Œæ¡ˆä¾‹å¦‚ä¸‹ï¼š</p>
<div class="code-container" data-rel="C#"><figure class="iseeu highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Money</span> &#123;</span><br><span class="line">    <span class="comment">// é‡‘é¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> amount &#123;<span class="keyword">get</span>;<span class="keyword">set</span>;&#125;</span><br><span class="line">    <span class="comment">// å¹£å€¼</span></span><br><span class="line">    <span class="keyword">public</span> Currency currency &#123;<span class="keyword">get</span>;<span class="keyword">set</span>;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// other place in applications...</span></span><br><span class="line"><span class="keyword">var</span> money = <span class="keyword">new</span> Money();</span><br><span class="line"></span><br><span class="line">money.amount = <span class="number">100</span>;</span><br><span class="line">money.currency = <span class="keyword">new</span> Currency.getinstance(locale.JP);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ignore hundred lines of codes...</span></span><br><span class="line"></span><br><span class="line">money.amount = <span class="number">-100</span>; <span class="comment">// ç„¡æ•ˆå€¼è¢«å‚³å…¥</span></span><br><span class="line">money.currency = <span class="keyword">new</span> Currency.getinstance(locale.US); <span class="comment">// å…§å®¹è¢«éš¨è™•ä»»æ„è¦†è“‹</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// calculate</span></span><br><span class="line"><span class="keyword">var</span> moneyB = <span class="keyword">new</span> Money();</span><br><span class="line">moneyB.amount = <span class="number">1000</span>;</span><br><span class="line">moneyB.currency = <span class="keyword">new</span> Currency.getinstance(locale.US);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> total = money.amount + moneyB.amount; <span class="comment">// å¹£å€¼ä¸åŒå»å¯ä»¥è¨ˆç®—ï¼Œä¸”è¨ˆç®—é‚è¼¯æš´éœ²åœ¨ Monrey å¤–</span></span><br></pre></td></tr></table></figure></div>

<p>å»ºç«‹ç©©å›ºçš„é¡åˆ¥å¯ä»¥éµç…§ï¼š</p>
<ul>
<li>å»ºæ§‹å¼åˆå§‹åŒ–å€¼</li>
<li>åˆå§‹åŒ–æ™‚æª¢æŸ¥æœ‰æ•ˆæ€§</li>
<li>é¡åˆ¥æˆå“¡é è¨­ç‚ºä¸å¯ä¿®æ­£</li>
<li>ä¿®æ­£æ™‚å›å‚³å‚³å…¥èˆ‡å›å‚³ç‰©ä»¶</li>
</ul>
<p>ä¾‹å¦‚</p>
<div class="code-container" data-rel="C#"><figure class="iseeu highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Money</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Money</span>(<span class="params"><span class="built_in">int</span> amount , Currency currency</span>)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(amount &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">&quot;é‡‘é¡éœ€å¤§æ–¼ 0&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(currency == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">&quot;å¹£å€¼ä¸å¾—ç‚ºç©º&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>._amount = amount;</span><br><span class="line">        <span class="keyword">this</span>._currency = currency;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é‡‘é¡</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> <span class="built_in">int</span> _amount;</span><br><span class="line">    <span class="comment">// å¹£å€¼</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> Currency _currency;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Amount</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123; <span class="keyword">return</span> _amount; &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Currency Currency</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123; <span class="keyword">return</span> _currency; &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Money <span class="title">Add</span>(<span class="params">Money other</span>)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æª¢é©—å¹£å€¼</span></span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">this</span>._currency.Equals(other.Currency)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">&quot;å¹£å€¼ä¸åŒ&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> added = <span class="keyword">this</span>._amount + other.Amount;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é€éåˆå§‹åŒ–å†æ¬¡ç¢ºä¿å€¼é€šéæª¢é©—</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Money(added,<span class="keyword">this</span>._currency);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="å€¼ç‰©ä»¶"><a href="#å€¼ç‰©ä»¶" class="headerlink" title="å€¼ç‰©ä»¶"></a>å€¼ç‰©ä»¶</h3><p>æŠŠç¨‹å¼ç¢¼ä¸­çš„å€¼å·²ç‰©ä»¶è¡¨ç¤ºï¼Œä¾†æé«˜ç¨‹å¼ç¢¼çš„åš´è¬¹èˆ‡å…§èšç¨‹åº¦ã€‚</p>
<p>æ¯”å¦‚</p>
<div class="code-container" data-rel="C#"><figure class="iseeu highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Money</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Amount;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¹£å€¼æˆå“¡ï¼Œå¯ä»¥æˆç«‹æ¯”å¦‚ï¼š &quot;JP&quot; &quot;US&quot; ...ï¼Œ</span></span><br><span class="line">    <span class="comment">// ä½†å½ˆæ€§å¤ªå¤§äº†å¸¶ &quot;Apple&quot; å°ç³»çµ±èªªä¹Ÿä¸æœƒæœ‰éŒ¯</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Currency;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åŒç† otherAmount å¯ä»¥å¸¶å…¥ count,page ... ç­‰æ•¸å­—å‹åˆ¥çš„åƒæ•¸ï¼Œ</span></span><br><span class="line">    <span class="comment">// ç¨‹å¼ä¸¦ä¸æœƒå ±éŒ¯</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Money <span class="title">Add</span>(<span class="params"><span class="built_in">int</span> otherAmount</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.Amount + otherAmount;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>æ”¹ç”¨ç‰©ä»¶ä¾†å–ä»£åŸå§‹å‹åˆ¥çš„å€¼ï¼Œé›–ç„¶è¼ƒå†—é•·ï¼Œä½†èƒ½ç¢ºä¿æ¥å—èˆ‡è¼¸å‡ºçš„å€¼éƒ½æ˜¯æ­£ç¢ºä¸”ç›¸é—œçš„ã€‚</p>
<div class="code-container" data-rel="C#"><figure class="iseeu highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Money</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// çœç•¥ ...</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Currency Currency</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123; <span class="keyword">return</span> _currency; &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Money <span class="title">Add</span>(<span class="params">Money other</span>)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">this</span>._currency.Equals(other.Currency)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">&quot;å¹£å€¼ä¸åŒ&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> added = <span class="keyword">this</span>._amount + other.Amount;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Money(added,<span class="keyword">this</span>._currency);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<br/>

<h3 id="èª¤ç”¨çš„å…±ç”¨é¡åˆ¥"><a href="#èª¤ç”¨çš„å…±ç”¨é¡åˆ¥" class="headerlink" title="èª¤ç”¨çš„å…±ç”¨é¡åˆ¥"></a>èª¤ç”¨çš„å…±ç”¨é¡åˆ¥</h3><p>åœ¨ç³»çµ±é–‹ç™¼ä¸­ï¼Œè‹¥åŒä¸€æ®µç¨‹å¼ç¢¼ç¶“å¸¸éœ€è¦é‡è¤‡ä½¿ç”¨ï¼Œé€šå¸¸æœƒå¯«æˆéœæ…‹å‡½å¼ä¸¦æ”¾ç½®æ–¼æŸå€‹å…±ç”¨é¡åˆ¥ä¸­ï¼Œå–åç‚ºï¼šUtilty æˆ– Common â€¦ã€‚</p>
<div class="code-container" data-rel="C#"><figure class="iseeu highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Common</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¨ˆç®—å«ç¨…é‡‘é¡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">calcAmmonutIcludingTax</span>(<span class="params"><span class="built_in">int</span> ammount,<span class="built_in">int</span> taxRate</span>)</span> &#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è½‰æ›æ•¸å­—æˆä¸­æ–‡æ•¸å­—</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">convertNumberToChinese</span>(<span class="params"><span class="built_in">string</span> text</span>)</span> &#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>ä¸è‡ªè¦º Common å°‡è¶Šå¤šè¶Šé›œï¼Œé€ æˆâ€œä½å…§èšâ€çš„æƒ…æ³ã€‚ä½å…§èšï¼Œæ¯”å¦‚æœ‰éœ€æ±‚è¦ä¿®æ”¹ç¨…å‹™ç›¸é—œé‚è¼¯æ™‚ï¼Œå¦‚æœç³»çµ±ç¨…å‹™çš„é‚è¼¯åŒæ™‚æ•£è½æ–¼å„è™•ï¼Œç½®æ–¼ Common ä¸­çš„ç›¸é—œå‡½å¼ï¼Œå› ç‚ºé›£ä»¥ä¸€æ™‚è¯æƒ³åˆ°è¦é€²ä¾†ç¢ºèªå‰‡å¯èƒ½å°è‡´ä¿®æ”¹æ™‚éºæ¼è€Œå‡ºéŒ¯ã€‚</p>
<p>æœƒé€ æˆä¸Šè¿°åŸå› ä½¿å› ç‚ºèª¤æœƒäº† â€œå¸¸ç”¨â€ èˆ‡ â€é€šç”¨â€œï¼Œé€šç”¨ä¸æ¶‰åŠç‰¹å®šå•†æ¥­é‚è¼¯ï¼Œæ¯”å¦‚ï¼šä¾‹å¤–è™•ç†ã€éŒ¯èª¤æª¢æ¸¬ã€å¤§å°å¯«è½‰æ›ï¼Œè€Œå¸¸ç”¨å‰‡ç›¸åï¼Œä»¥ä¸Šè¿°æ¡ˆä¾‹ä¾†èªªï¼Œç³»çµ±ä¸­å¯èƒ½å¾ˆå¤šåœ°æ–¹éœ€è¦è¨ˆç®—å«ç¨…é‡‘é¡ï¼Œé€™æ™‚æ›´å¥½çš„è™•ç†æ–¹å¼ç‚ºï¼Œæ–°å¢ä¸€å€‹é¡æ¯”å¦‚ï¼š</p>
<div class="code-container" data-rel="C#"><figure class="iseeu highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">AmmonutIcludingTax</span> &#123;</span><br><span class="line">    <span class="comment">// calcAmmonutIcludingTax ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<br/>

<h3 id="æœ€å°‘çŸ¥è­˜åŸå‰‡"><a href="#æœ€å°‘çŸ¥è­˜åŸå‰‡" class="headerlink" title="æœ€å°‘çŸ¥è­˜åŸå‰‡"></a>æœ€å°‘çŸ¥è­˜åŸå‰‡</h3><p>åˆå¯ç†è§£ç‚ºï¼Œå°ç‰©ä»¶â€œåªä¸‹ä»¤ï¼Œä¸è©¢å•â€ï¼Œåä¾‹æ¯”å¦‚ï¼š</p>
<div class="code-container" data-rel="C#"><figure class="iseeu highlight c#"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Address</span> &#123;</span><br><span class="line">   <span class="built_in">string</span> City</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Customer</span> &#123;</span><br><span class="line">    Address Address</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">OrderHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">HandleOrder</span>(<span class="params">Customer customer</span>)</span> &#123;</span><br><span class="line">        <span class="built_in">string</span> city = customer.Address.City; <span class="comment">// é•ååŸå‰‡</span></span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;<span class="subst">&#123;city&#125;</span> order has been handled.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>æ­¤è™•ï¼Œè¦å¾—çŸ¥ City å¾—çŸ¥é“ Customer &gt; Address &gt; City å±¤å±¤é—œä¿‚ï¼Œä¸ä½†æœ‰éå¤šè³‡è¨Šï¼Œä¸”è‹¥æ˜¯ Customer çš„ Address è¢«ç§»é™¤æˆ–æ”¹è®Šå¯¦ä½œæ–¹å¼é€™é‚Šå°±å¿…é ˆè·Ÿè‘—ä¿®æ”¹ã€‚</p>
<p>é‡å° City â€œåªä¸‹ä»¤ï¼Œä¸è©¢å•â€:</p>
<div class="code-container" data-rel="C#"><figure class="iseeu highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Address</span> &#123;</span><br><span class="line">   <span class="built_in">string</span> City</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Customer</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> Address Address</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    <span class="keyword">public</span> <span class="built_in">string</span> <span class="title">GetCity</span>()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Address.City;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">OrderHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">HandleOrder</span>(<span class="params">Customer customer</span>)</span> &#123;</span><br><span class="line">        <span class="built_in">string</span> city = customer.GetCity(); <span class="comment">// ä¿®æ­£</span></span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;<span class="subst">&#123;city&#125;</span> order has been handled.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>å¦‚æ­¤ï¼ŒOrderHandler å®Œå…¨ä¸éœ€è¦çŸ¥é“ Customer å…§éƒ¨å…¶å¯¦æ˜¯é€é Address å–å¾— City çš„ï¼Œä¸”ç•¶ Address èˆ‡ City çš„é—œä¿‚æœ‰æ”¹è®Šæ™‚ï¼Œä¹Ÿå®Œå…¨ä¸é—œ å¦‚æ­¤ï¼ŒOrderHandler çš„äº‹ï¼Œåªè¦èª¿æ•´ Customer ç‰©ä»¶å³å¯ã€‚</p>
<p>2024&#x2F;11&#x2F;19 æŒçºŒæ›´æ–°ä¸­ â€¦</p>
]]></content>
      <categories>
        <category>Backend</category>
      </categories>
      <tags>
        <tag>C#</tag>
      </tags>
  </entry>
  <entry>
    <title>Event-loop</title>
    <url>/blog.github.io/2025/03/26/event-loop/</url>
    <content><![CDATA[<h3 id="ğŸ“Œ-JavaScript-æ˜¯å–®åŸ·è¡Œç·’çš„èªè¨€"><a href="#ğŸ“Œ-JavaScript-æ˜¯å–®åŸ·è¡Œç·’çš„èªè¨€" class="headerlink" title="ğŸ“Œ JavaScript æ˜¯å–®åŸ·è¡Œç·’çš„èªè¨€"></a><strong>ğŸ“Œ JavaScript æ˜¯å–®åŸ·è¡Œç·’çš„èªè¨€</strong></h3><p>JavaScript <strong>ä¸€æ¬¡åªèƒ½åŸ·è¡Œä¸€ä»¶äº‹</strong>ï¼ˆåŒæ­¥ Syncï¼‰ï¼Œå¦‚æœé‡åˆ°éœ€è¦ç­‰å¾…çš„æ“ä½œï¼ˆå¦‚ <strong>è®€å–è³‡æ–™ã€è¨ˆæ™‚ã€API è«‹æ±‚</strong>ï¼‰ï¼Œå®ƒå°±æœƒå¡ä½ï¼Œå°è‡´ä½¿ç”¨è€…é«”é©—è®Šå·®ã€‚</p>
<p><strong>ç‚ºäº†è§£æ±ºé€™å€‹å•é¡Œï¼Œç€è¦½å™¨æä¾› Event Loop</strong>ï¼Œè®“ JavaScript é€é <strong>éåŒæ­¥æ©Ÿåˆ¶ï¼ˆAsyncï¼‰</strong> ä¾†è™•ç†ã€Œç­‰å¾…ä¸­çš„äº‹æƒ…ã€ï¼Œè®“å…¶ä»–ç¨‹å¼èƒ½ç¹¼çºŒåŸ·è¡Œï¼Œä¸æœƒå¡ä½æ•´å€‹ç¶²é ã€‚</p>
<hr>
<h3 id="ğŸ“Œ-Event-Loop-çš„æ ¸å¿ƒæ©Ÿåˆ¶"><a href="#ğŸ“Œ-Event-Loop-çš„æ ¸å¿ƒæ©Ÿåˆ¶" class="headerlink" title="ğŸ“Œ Event Loop çš„æ ¸å¿ƒæ©Ÿåˆ¶"></a><strong>ğŸ“Œ Event Loop çš„æ ¸å¿ƒæ©Ÿåˆ¶</strong></h3><ol>
<li><strong>Call Stackï¼ˆå‘¼å«å †ç–Šï¼‰ï¼š</strong><ul>
<li>JavaScript æœƒ<strong>æŠŠæ‰€æœ‰åŒæ­¥ç¨‹å¼ç¢¼æ”¾é€² Call Stack åŸ·è¡Œ</strong>ï¼Œæ¯æ¬¡åªåŸ·è¡Œä¸€å€‹ã€‚</li>
</ul>
</li>
<li><strong>é‡åˆ°éåŒæ­¥æ“ä½œï¼ˆå¦‚ setTimeoutã€Promiseã€DOM äº‹ä»¶ï¼‰ï¼š</strong><ul>
<li>é€™äº›éåŒæ­¥æ“ä½œæœƒäº¤çµ¦ <strong>Web APIï¼ˆç€è¦½å™¨æä¾›çš„åŠŸèƒ½ï¼‰</strong> åœ¨<strong>èƒŒæ™¯åŸ·è¡Œ</strong>ï¼Œä¸æœƒå¡ä½ Call Stackã€‚</li>
</ul>
</li>
<li><strong>Web API åŸ·è¡Œå®Œæˆå¾Œï¼š</strong><ul>
<li>å®ƒæœƒ<strong>æŠŠå°æ‡‰çš„å›èª¿å‡½å¼ï¼ˆcallbackï¼‰æ”¾é€² Task Queueï¼ˆä»»å‹™ä½‡åˆ—ï¼‰</strong> æˆ– <strong>Microtask Queueï¼ˆå¾®ä»»å‹™ä½‡åˆ—ï¼‰</strong>ï¼Œç­‰å¾…åŸ·è¡Œã€‚</li>
</ul>
</li>
<li><strong>Event Loop è² è²¬å”èª¿</strong><ul>
<li>ç•¶ <strong>Call Stack æ¸…ç©ºæ™‚</strong>ï¼ŒEvent Loop æœƒå¾ <strong>Microtask Queueï¼ˆPromise, MutationObserverï¼‰</strong> å…ˆå–å‡ºä»»å‹™åŸ·è¡Œï¼Œç„¶å¾Œæ‰è¼ªåˆ° <strong>Task Queueï¼ˆsetTimeout, setInterval, DOM äº‹ä»¶ï¼‰</strong>ã€‚</li>
</ul>
</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/blog.github.io/2025/03/26/event-loop/event-loop.png"
                      alt="event-loop.png"
                ></p>
<p><strong>ç¯„ä¾‹</strong></p>
<ol>
<li>call stack åŸ·è¡Œå°å‡º Hi</li>
<li>call stack å°‡ setTimeout äº¤çµ¦ Web API è¨­ç½® 5 ç§’ timer</li>
<li>call stack å°å‡º JSConfEU åŒæ™‚ timer ç¹¼çºŒ</li>
<li>call stack çµæŸ</li>
<li>Web API 5 ç§’å¾ŒæŠŠ cb function äº¤çµ¦ task queue</li>
<li>event loop æª¢æŸ¥ call stack ç‚ºç©ºï¼Œtask queue æœ‰ä»»å‹™å°±æ‹‰é€²ä¾†åŸ·è¡Œ</li>
<li>call stack å°å‡º there</li>
</ol>
<br/>

<p><strong>è£œå…… Micro task Queue</strong></p>
<p>å…¨éƒ¨çš„ Microtask Queue åŸ·è¡Œå®Œæˆæ‰æœƒåŸ·è¡Œåˆ° Task Queueã€‚<br>è‹¥ç€è¦½å™¨æ²’æœ‰ Micro task Queue æ©Ÿåˆ¶ï¼Œå¯èƒ½æœƒä½¿ç¨‹å¼çš„çµæœå¤±å»ç©©å®šæ€§ã€‚</p>
<div class="code-container" data-rel="Jsx"><figure class="iseeu highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> value = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">resolve</span>().<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  value = <span class="number">100</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(value); <span class="comment">// ğŸ”¹ è‹¥æœŸå¾…çµæœç‚º 100</span></span><br><span class="line">&#125;, <span class="number">0</span>);</span><br></pre></td></tr></table></figure></div>

<p>å‡å¦‚æ²’æœ‰å®šå„ªå…ˆé †åºï¼Œçµæœå¯èƒ½æ˜¯ä¸ç©©å®šçš„ï¼ŒPromise å¿«å°±æœƒ print 100 ; è¼ƒæ…¢å°±æœƒ print 0ã€‚</p>
<hr>
<h3 id="ğŸ“Œ-å»¶ä¼¸ï¼šRender-Queue"><a href="#ğŸ“Œ-å»¶ä¼¸ï¼šRender-Queue" class="headerlink" title="ğŸ“Œ å»¶ä¼¸ï¼šRender Queue"></a><strong>ğŸ“Œ å»¶ä¼¸ï¼šRender Queue</strong></h3><p>ç€è¦½å™¨ç•«é¢å¾—ä»¥åˆ·æ–°ï¼Œä¸»è¦æ˜¯æ¯ä¸€å¹€( ç´„ 16 ms ) Render Queue æ’é€² call stack åŸ·è¡Œç•«é¢æ›´æ–°ã€‚</p>
<p>ç•¶ç•«é¢ block ä½äº†æ²’æœ‰åæ‡‰å°±ä»£è¡¨ call stack é‚„æœ‰å·¥ä½œ Render Queue ç„¡æ³•å¦‚æœŸæ’é€²ã€‚</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/blog.github.io/2025/03/26/event-loop/render-queue.png"
                      alt="render-queue.png"
                ></p>
<p>(1) æ¯ä¸€å¹€çš„æ™‚é–“ (2) call stack ç‚ºç©º ï¼ŒEvent Lop å°±æœƒæ’ Render Queue å·¥ä½œã€‚</p>
<br/>

<p><strong>åƒè€ƒ</strong><br><a class="link"   href="https://www.youtube.com/watch?v=8aGhZQkoFbQ" >æ‰€ä»¥èªª event loop åˆ°åº•æ˜¯ä»€éº¼ç©æ„å…’ï¼Ÿ| Philip Roberts | JSConf EU<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a><br><a class="link"   href="http://latentflip.com/loupe/?code=JC5vbignYnV0dG9uJywgJ2NsaWNrJywgZnVuY3Rpb24gb25DbGljaygpIHsKICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gdGltZXIoKSB7CiAgICAgICAgY29uc29sZS5sb2coJ1lvdSBjbGlja2VkIHRoZSBidXR0b24hJyk7ICAgIAogICAgfSwgMjAwMCk7Cn0pOwoKY29uc29sZS5sb2coIkhpISIpOwoKc2V0VGltZW91dChmdW5jdGlvbiB0aW1lb3V0KCkgewogICAgY29uc29sZS5sb2coIkNsaWNrIHRoZSBidXR0b24hIik7Cn0sIDUwMDApOwoKY29uc29sZS5sb2coIldlbGNvbWUgdG8gbG91cGUuIik7!!!PGJ1dHRvbj5DbGljayBtZSE8L2J1dHRvbj4=" >Loupe - event loop è¦–è¦ºæ¨¡æ“¬å·¥å…·<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
]]></content>
      <categories>
        <category>Frontend</category>
      </categories>
      <tags>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title>Google reCAPTCHA For Web</title>
    <url>/blog.github.io/2024/10/22/google-recpatcha/</url>
    <content><![CDATA[<h2 id="åŠŸèƒ½"><a href="#åŠŸèƒ½" class="headerlink" title="åŠŸèƒ½"></a>åŠŸèƒ½</h2><p>é˜²ç¯„æ©Ÿå™¨äºº</p>
<ul>
<li>æäº¤å¤§é‡åƒåœ¾è¨Šæ¯</li>
<li>è©¦éŒ¯æ³•æš´åŠ›ç ´è§£æ•æ„Ÿè³‡è¨Š</li>
<li>å¤§é‡è‡ªå‹•è¨»å†Š</li>
<li>çŸ­æ™‚é–“å¤§é‡è«‹æ±‚</li>
</ul>
<h2 id="ç´šåˆ¥"><a href="#ç´šåˆ¥" class="headerlink" title="ç´šåˆ¥"></a>ç´šåˆ¥</h2><p>Essentialsã€Standardã€Enterprise</p>
<p>åªè¦ Google Cloud project ç¶å®šä»˜æ¬¾å¸³æˆ¶å°±æœ‰ Standard ç´šåˆ¥ï¼Œæ¯æœˆ reCAPTCHA æœå‹™æµé‡åˆ°é”ä¸€å®šæ•¸é‡å‰‡è‡ªå‹•å‡ç‚º Enterpriseã€‚<br>Standardã€Enterprise ç´šåˆ¥çš„è©•ä¼°åˆ†æ•¸æœ‰ 11 levels æä¾›æ›´ç´°è†©çš„è©•åˆ¤æ¨™æº–ã€‚</p>
<p>åƒè€ƒ: <a class="link"   href="https://cloud.google.com/recaptcha/docs/compare-tiers" >https://cloud.google.com/recaptcha/docs/compare-tiers<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
<h2 id="reCAPTCHA-Keys"><a href="#reCAPTCHA-Keys" class="headerlink" title="reCAPTCHA Keys"></a>reCAPTCHA Keys</h2><ul>
<li>( v2 ç‰ˆæœ¬ ) Checkbox keyï¼Œéœ€ä½¿ç”¨è€…æ‰‹å‹•é©—è­‰ï¼Œå¸¸è¦‹çš„ä¹å®®æ ¼é©—è­‰</li>
<li>( v3 ç‰ˆæœ¬ ) Score-based keyï¼Œè‡ªå‹•é©—è­‰ (å®˜æ–¹æ¨è–¦)</li>
</ul>
<p>åƒè€ƒ: <a class="link"   href="https://cloud.google.com/recaptcha/docs/choose-key-type" >https://cloud.google.com/recaptcha/docs/choose-key-type<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
<h2 id="é‹ä½œ"><a href="#é‹ä½œ" class="headerlink" title="é‹ä½œ"></a>é‹ä½œ</h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/blog.github.io/2024/10/22/google-recpatcha/reCAPTCHAFlow.png"
                      alt="reCAPTCHAFlow"
                ></p>
<ol>
<li>ä½¿ç”¨è€…è¡Œç‚ºï¼Œå¦‚é€å‡ºè¡¨å–®æ™‚ï¼Œç™¼é€ç›£æ¸¬è¨˜éŒ„çµ¦ reCAPTCHA</li>
<li>reCAPTCHA å›å‚³åŠ å¯†çš„åˆ†æçµæœ</li>
<li>å‰ç«¯é ˆå†å°‡åŠ å¯†çµæœï¼Œäº¤ç”±å¾Œç«¯ç™¼é€çµ¦ reCAPTCHA è§£å¯†</li>
<li>reCAPTCHA å›æ‡‰çµ¦å¾Œç«¯</li>
<li>é–‹ç™¼äººå“¡ä¾æ“šè©•ä¼°åˆ†æ•¸æ±ºå®šè¡Œç‚ºï¼Œå¦‚:åˆ¤æ–·ç„¡æ•ˆè¡¨å–®</li>
</ol>
<h2 id="è¨­å®šç¸½è¦½"><a href="#è¨­å®šç¸½è¦½" class="headerlink" title="è¨­å®šç¸½è¦½"></a>è¨­å®šç¸½è¦½</h2><p>Google Cloud</p>
<ol>
<li>å•Ÿç”¨ reCAPTCHA Enterprise API</li>
<li>åœ¨ API å’Œæœå‹™çš„â€æ†‘è­‰â€å»ºç«‹é‡‘é‘°ï¼Œé‡‘é‘°å¯ä»¥è¨­å®šé™åˆ¶æ‡‰ç”¨ç¨‹å¼ã€API ( åŠŸç”¨: è§£å¯† reCAPTCHA è©•ä¼°çµæœ )<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/blog.github.io/2024/10/22/google-recpatcha/set-site-key.png"
                      alt="set-site-key"
                ></li>
<li>åœ¨å®‰å…¨æ€§çš„â€reCAPTCHAâ€ï¼Œå»ºç«‹é‡‘é‘° ( åŠŸç”¨: ç›£æ¸¬ã€é€å‡ºç›£æ¸¬è¨˜éŒ„ )<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/blog.github.io/2024/10/22/google-recpatcha/set-score-key.png"
                      alt="set-score-key"
                ></li>
</ol>
<p>ç¶²ç«™</p>
<ol>
<li>è¦ç›£æ¸¬çš„é é¢ head æ¨™ç±¤è¼‰å…¥</li>
</ol>
<div class="code-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://www.google.com/recaptcha/enterprise.js?render=$&#123;RECAPTCHA_SITE_KEY&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<ol start="2">
<li>ä½¿ç”¨è€…è¡Œç‚ºè§¸ç™¼é€å‡ºç›£æ¸¬è¨˜éŒ„</li>
</ol>
<div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é€å‡ºè¡¨å–®è§¸ç™¼</span></span><br><span class="line"><span class="keyword">const</span> siteKey = <span class="variable constant_">RECAPTCHA_SITE_KEY</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!siteKey) &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;reCAPTCHA site key is not defined&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç²å–åŠ å¯†çµæœ</span></span><br><span class="line"><span class="keyword">const</span> token = <span class="keyword">await</span> grecaptcha.<span class="property">enterprise</span>.<span class="title function_">execute</span>(siteKey, &#123;</span><br><span class="line">  actionName,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!token) &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;Failed to obtain reCAPTCHA token&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è§£æçµæœä¸¦çœ‹å¾Œç«¯è¦å›å‚³ä»€éº¼è™•ç½®</span></span><br><span class="line"><span class="keyword">await</span> <span class="title function_">getRecaptchaResult</span>(token, actionName);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‰ç«¯è™•ç†...</span></span><br></pre></td></tr></table></figure></div>

<ol start="3">
<li>å¾Œç«¯</li>
</ol>
<div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å¾Œç«¯è§£å¯†çµæœ</span></span><br><span class="line"><span class="keyword">const</span> response = <span class="keyword">await</span> axios.<span class="title function_">post</span>(</span><br><span class="line">  <span class="string">`https://recaptchaenterprise.googleapis.com/v1/projects/<span class="subst">$&#123;projectName&#125;</span>/assessments?key=<span class="subst">$&#123;RECAPTCHA_API_KEY&#125;</span>`</span>,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">event</span>: &#123;</span><br><span class="line">      <span class="attr">token</span>: req.<span class="property">body</span>.<span class="property">token</span>,</span><br><span class="line">      <span class="attr">siteKey</span>: <span class="variable constant_">RECAPTCHA_SITE_KEY</span>,</span><br><span class="line">      <span class="attr">expectedAction</span>: req.<span class="property">body</span>.<span class="property">actionName</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> data = <span class="keyword">await</span> response.<span class="property">data</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// token ç„¡æ•ˆ</span></span><br><span class="line"><span class="keyword">if</span> (!data.<span class="property">tokenProperties</span>.<span class="property">valid</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">json</span>(&#123;</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&quot;Invalid token from google recaptcha enterprise API&quot;</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// éé æœŸ action</span></span><br><span class="line"><span class="keyword">if</span> (!actionNames.<span class="title function_">includes</span>(data.<span class="property">tokenProperties</span>.<span class="property">action</span>)) &#123;</span><br><span class="line">  <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">json</span>(&#123;</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&quot;Invalid action from google recaptcha enterprise API&quot;</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> score = data.<span class="property">riskAnalysis</span>.<span class="property">score</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¾Œç«¯è™•ç†...</span></span><br></pre></td></tr></table></figure></div>

<p>åƒè€ƒ:<br><br/><br><a class="link"   href="https://cloud.google.com/recaptcha/docs/setup-overview-web" >https://cloud.google.com/recaptcha/docs/setup-overview-web<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a><br><br/><br><a class="link"   href="https://cloud.google.com/recaptcha/docs/instrument-web-pages" >https://cloud.google.com/recaptcha/docs/instrument-web-pages<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
]]></content>
      <categories>
        <category>Frontend</category>
      </categories>
      <tags>
        <tag>ï¼§oogle APIs</tag>
      </tags>
  </entry>
  <entry>
    <title>netCore-middleware</title>
    <url>/blog.github.io/2024/10/22/netCore-middleware/</url>
    <content><![CDATA[<h2 id="ASP-NET-Core-Middleware"><a href="#ASP-NET-Core-Middleware" class="headerlink" title="ASP.NET Core Middleware"></a>ASP.NET Core Middleware</h2><p>Middleware is software thatâ€™s assembled into an app pipeline to handle requests and responses , as below</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/blog.github.io/2024/10/22/netCore-middleware/request-delegate-pipeline.png"
                      alt="request-delegate-pipeline"
                ></p>
<p><a class="link"   href="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/middleware/?view=aspnetcore-8.0" >ref : ASP.NET Core Middleware<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
<p>itâ€™s ok to setup middleware with single or chained multiples, example :</p>
<p>ASP.NET Core Program.cs file with</p>
<p>( single middleware return result directly )</p>
<div class="code-container" data-rel="C#"><figure class="iseeu highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(args);</span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line">app.Run(<span class="keyword">async</span> context =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;Hello world!&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.Run();</span><br></pre></td></tr></table></figure></div>

<p>( chained middlewares by app.Use(â€¦) )</p>
<div class="code-container" data-rel="C#"><figure class="iseeu highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(args);</span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line">app.Use(<span class="keyword">async</span> (context, next) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Do work that can write to the Response.</span></span><br><span class="line">    <span class="keyword">await</span> next.Invoke();</span><br><span class="line">    <span class="comment">// Do logging or other work that doesn&#x27;t write to the Response.</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.Run(<span class="keyword">async</span> context =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;Hello from 2nd delegate.&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.Run();</span><br></pre></td></tr></table></figure></div>

<h2 id="Short-circuiting-the-request-pipeline"><a href="#Short-circuiting-the-request-pipeline" class="headerlink" title="Short-circuiting the request pipeline"></a>Short-circuiting the request pipeline</h2><p>the request could Short-circuiting to avoid unnecessary work, ex : add an static file middleware to hanldle static file request when the middleware been triggered it would response and ignore the middleware after.</p>
<h2 id="Run-delegates"><a href="#Run-delegates" class="headerlink" title="Run delegates"></a>Run delegates</h2><p>is the end of middleware , Run or Use keywords after the first Run keyword would not be called.</p>
<h2 id="Middleware-order"><a href="#Middleware-order" class="headerlink" title="Middleware order"></a>Middleware order</h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/blog.github.io/2024/10/22/netCore-middleware/middleware-pipeline.svg"
                      alt="middleware-pipeline"
                ></p>
<p>official provided recommonded order for the middleware , but the user can control over order by own. ( the order is determine by the code order )</p>
<p>Why is there official pre-ordered order recommonded ?</p>
<ul>
<li><strong>Ensure Correct Functionality</strong> : <code>UseAuthentication</code> must run before <code>UseAuthorization</code> because the user must be authenticated before checking their permissions</li>
<li><strong>Optimize Performance</strong> : By processing certain tasks earlier, such as static file requests or health checks, you can bypass more complex operations like authentication when they arenâ€™t needed<br>Why is the order important ?</li>
</ul>
<br/>
<b>
As mentioned above "app.Run()" is the termianal of middlewares and in the img here shown endpoint is the end of middleware. So what are there relationships?
</b>
<br/><br/>

<p>If app.Run() is placed before app.UseEndpoints(), MVC or Razor Pages endpoints will not execute. If placed after, it will only be hit if no endpoint matches the route.</p>
<p>Since app.UseEndpoints() is responsible for executing the endpoint of your application (the actual logic that serves the request), app.Run() typically does not need to be used for handling requests in most standard cases, because MVC and Razor Pages handle requests fully.</p>
<b>
When to use app.Run() ?
</b>

<ul>
<li>short-circuits</li>
<li>simple app that no need for full MVC framework endpoint</li>
</ul>
<br/>

<p>example :</p>
<div class="code-container" data-rel="C#"><figure class="iseeu highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(args);</span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. é¦–å…ˆé…ç½®ç•°å¸¸è™•ç†ä¸­é–“ä»¶</span></span><br><span class="line"></span><br><span class="line">app.UseExceptionHandler(<span class="string">&quot;/error&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. ç¬¬ä¸€å€‹ä¸­é–“ä»¶</span></span><br><span class="line">app.Use(<span class="keyword">async</span> (context, next) =&gt;</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> currentPath = context.Request.Path;</span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;ä¸­é–“ä»¶ 1 - é€²å…¥ [<span class="subst">&#123;currentPath&#125;</span>]&quot;</span>);</span><br><span class="line">    <span class="keyword">await</span> next();</span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;ä¸­é–“ä»¶ 1 - è¿”å› [<span class="subst">&#123;currentPath&#125;</span>]&quot;</span>);</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. ç¬¬äºŒå€‹ä¸­é–“ä»¶ï¼ˆæ‹‹å‡ºç•°å¸¸çš„ä¸­é–“ä»¶ï¼‰</span></span><br><span class="line">app.Use(<span class="keyword">async</span> (context, next) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> currentPath = context.Request.Path;</span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;ä¸­é–“ä»¶ 2 - é€²å…¥ [<span class="subst">&#123;currentPath&#125;</span>]&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å…ˆèª¿ç”¨ next()</span></span><br><span class="line">    <span class="keyword">await</span> next();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç¢ºä¿åœ¨æ‹‹å‡ºç•°å¸¸ä¹‹å‰æ²’æœ‰å¯«å…¥éŸ¿æ‡‰</span></span><br><span class="line">    <span class="keyword">if</span> (currentPath == <span class="string">&quot;/&quot;</span> &amp;&amp; !context.Response.HasStarted)</span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;ä¸­é–“ä»¶ 2 - å³å°‡æ‹‹å‡ºç•°å¸¸&quot;</span>);</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">&quot;ä¸­é–“ä»¶ 2 è¿”å›æ™‚æ‹‹å‡ºç•°å¸¸&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;ä¸­é–“ä»¶ 2 - è¿”å› [<span class="subst">&#123;currentPath&#125;</span>]&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 5. é¦–é è·¯ç”±</span></span><br><span class="line">app.MapGet(<span class="string">&quot;/&quot;</span>, () =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;è™•ç†é¦–é è«‹æ±‚ [/]&quot;</span>);</span><br><span class="line">    <span class="comment">//return Results.Text(&quot;Hello World!&quot;, &quot;text/plain&quot;);</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 6. éŒ¯èª¤è™•ç†è·¯ç”±</span></span><br><span class="line">app.Map(<span class="string">&quot;/error&quot;</span>, <span class="keyword">async</span> context =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;é€²å…¥éŒ¯èª¤è™•ç†é é¢ [/error]&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> exceptionFeature =</span><br><span class="line">        context.Features.Get&lt;Microsoft.AspNetCore.Diagnostics.IExceptionHandlerPathFeature&gt;();</span><br><span class="line">    <span class="keyword">var</span> error = exceptionFeature?.Error;</span><br><span class="line">    <span class="keyword">var</span> originalPath = exceptionFeature?.Path;</span><br><span class="line"></span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;åŸå§‹è«‹æ±‚è·¯å¾‘: <span class="subst">&#123;originalPath&#125;</span>&quot;</span>);</span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;æ•æ‰åˆ°çš„éŒ¯èª¤: <span class="subst">&#123;error?.Message&#125;</span>&quot;</span>);</span><br><span class="line"></span><br><span class="line">    context.Response.ContentType = <span class="string">&quot;text/plain&quot;</span>;</span><br><span class="line">    <span class="keyword">await</span> context.Response.WriteAsync(</span><br><span class="line">        <span class="string">$&quot;éŒ¯èª¤å·²è¢«è™•ç†ï¼\n&quot;</span> +</span><br><span class="line">        <span class="string">$&quot;åŸå§‹è«‹æ±‚: <span class="subst">&#123;originalPath&#125;</span>\n&quot;</span> +</span><br><span class="line">        <span class="string">$&quot;éŒ¯èª¤ä¿¡æ¯: <span class="subst">&#123;error?.Message&#125;</span>&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.Run();</span><br></pre></td></tr></table></figure></div>

<p>result :</p>
<div class="code-container" data-rel="Txt"><figure class="iseeu highlight txt"><table><tr><td class="code"><pre><span class="line">request: &quot;/&quot;</span><br><span class="line">1. ä¸­é–“ä»¶ 1 - é€²å…¥ [/]</span><br><span class="line">2. ä¸­é–“ä»¶ 2 - é€²å…¥ [/]</span><br><span class="line">3. è™•ç†é¦–é è«‹æ±‚ [/]</span><br><span class="line">4. ä¸­é–“ä»¶ 2 - å³å°‡æ‹‹å‡ºç•°å¸¸</span><br><span class="line">5. è§¸ç™¼ app.UseExceptionHandler(&quot;/error&quot;);</span><br><span class="line"></span><br><span class="line">request: &quot;/error&quot;</span><br><span class="line">1. ä¸­é–“ä»¶ 1 - é€²å…¥ [/error]</span><br><span class="line">2. ä¸­é–“ä»¶ 2 - é€²å…¥ [/error]</span><br><span class="line">3. é€²å…¥éŒ¯èª¤è™•ç†é é¢ [/error]</span><br><span class="line">   åŸå§‹è«‹æ±‚è·¯å¾‘: /</span><br><span class="line">   æ•æ‰åˆ°çš„éŒ¯èª¤ ä¸­é–“ä»¶ 2 - å³å°‡æ‹‹å‡ºç•°å¸¸</span><br><span class="line">4. ä¸­é–“ä»¶ 2 - è¿”å› [/error]</span><br><span class="line">5. ä¸­é–“ä»¶ 1 - è¿”å› [/error]</span><br></pre></td></tr></table></figure></div>

<p>Donâ€™t call next.Invoke during or after the response has been sent to the client.</p>
<h2 id="MVC-Endpoint"><a href="#MVC-Endpoint" class="headerlink" title="MVC Endpoint"></a>MVC Endpoint</h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/blog.github.io/2024/10/22/netCore-middleware/MVCEndpoint.png"
                      alt="MVCEndpoint"
                ></p>
]]></content>
      <categories>
        <category>Backend</category>
      </categories>
      <tags>
        <tag>.NET</tag>
      </tags>
  </entry>
  <entry>
    <title>React æ¸²æŸ“</title>
    <url>/blog.github.io/2025/01/18/react-render/</url>
    <content><![CDATA[<h2 id="æ¸²æŸ“ç­–ç•¥"><a href="#æ¸²æŸ“ç­–ç•¥" class="headerlink" title="æ¸²æŸ“ç­–ç•¥"></a>æ¸²æŸ“ç­–ç•¥</h2><p>ç¶²ç«™é é¢å¸¸è¦‹çµ„æˆï¼Œä»¥é›»å•†ç‚ºä¾‹ :</p>
<p>éœæ…‹é é¢</p>
<ul>
<li>ç‰¹æ€§ï¼šå…§å®¹å›ºå®šï¼Œæ‰€æœ‰ä½¿ç”¨è€…èˆ‡æ™‚é–“çš„è«‹æ±‚çµæœå‡ç›¸åŒ</li>
<li>ç¯„ä¾‹ï¼šä¼æ¥­ç¶“ç‡Ÿç†å¿µã€é—œæ–¼æˆ‘å€‘</li>
</ul>
<p>å‹•æ…‹é é¢</p>
<ul>
<li>ç‰¹æ€§ï¼šå…§å®¹å› ä½¿ç”¨è€…è«‹æ±‚æˆ–æœ€æ–°ç‹€æ…‹è€Œä¸åŒ</li>
<li>ç¯„ä¾‹ï¼šæˆ‘çš„è¨‚å–®ã€è³¼è²·ç´€éŒ„</li>
</ul>
<p>å‹•æ…‹é é¢å¯å»¶é²åˆ·æ–°</p>
<ul>
<li>ç‰¹æ€§ï¼šå…§å®¹å‹•æ…‹æ›´æ–°ï¼Œä½†å…è¨±æ¯éš”ä¸€æ®µæ™‚é–“æ‰åˆ·æ–°</li>
<li>ç¯„ä¾‹ï¼šç†±é–€å•†å“ã€æš¢éŠ·å•†å“é </li>
</ul>
<br/>

<table>
<thead>
<tr>
<th>æ¸²æŸ“ç­–ç•¥</th>
<th>æ¸²æŸ“æ™‚æ©Ÿ</th>
<th>æ€§èƒ½</th>
<th>ä¼ºæœå™¨è² è¼‰</th>
<th>æ›´æ–°æ•¸æ“šçš„èƒ½åŠ›</th>
<th>é©ç”¨å ´æ™¯</th>
</tr>
</thead>
<tbody><tr>
<td>SSR (Server-Side Rendering)</td>
<td>æ¯æ¬¡è«‹æ±‚æ™‚ä¼ºæœå™¨æ¸²æŸ“</td>
<td>æ…¢</td>
<td>é«˜</td>
<td>å³æ™‚æ›´æ–°</td>
<td>æˆ‘çš„è¨‚å–®ã€è³¼è²·ç´€éŒ„</td>
</tr>
<tr>
<td>SSG (Static Site Generation)</td>
<td>å»ºç½®æ™‚ç”Ÿæˆéœæ…‹ HTML</td>
<td>å¿«</td>
<td>ä½</td>
<td>ç„¡æ³•å³æ™‚æ›´æ–°</td>
<td>ä¼æ¥­ç¶“ç‡Ÿç†å¿µã€é—œæ–¼æˆ‘å€‘</td>
</tr>
<tr>
<td>ISR (Incremental Static Regeneration)</td>
<td>éœæ…‹ç”Ÿæˆ + å®šæ™‚æ›´æ–°</td>
<td>ä¸­</td>
<td>ä¸­</td>
<td>å®šæ™‚æ›´æ–°</td>
<td>ç†±é–€ã€æš¢éŠ·å•†å“é </td>
</tr>
</tbody></table>
<br/>

<h2 id="æ¸²æŸ“æ©Ÿåˆ¶"><a href="#æ¸²æŸ“æ©Ÿåˆ¶" class="headerlink" title="æ¸²æŸ“æ©Ÿåˆ¶"></a>æ¸²æŸ“æ©Ÿåˆ¶</h2><p>è‹¥ä»¥ SSR ç‚ºç¯„ä¾‹ï¼Œä½¿ç”¨è€…ç€è¦½é é¢æ™‚ :</p>
<p>é¦–æ¬¡æ¸²æŸ“åœ¨ä¼ºæœå™¨ç«¯</p>
<ol>
<li>ç”Ÿæˆéœæ…‹ HTML èˆ‡ JavaScript å®¢æˆ¶ç«¯</li>
<li>ç€è¦½å™¨æ¥æ”¶ä¸¦é¡¯ç¤ºéœæ…‹ HTML</li>
<li>åŠ è¼‰ä¸¦åŸ·è¡Œ JavaScript æ–‡ä»¶</li>
<li>ç”Ÿæˆ Virtual DOMï¼Œè‹¥åŒ…å«äº’å‹•äº‹ä»¶å‰‡å°‡éœæ…‹ HTML è½‰æ›ç‚ºå¯äº¤äº’çš„ React å…ƒç´ ï¼Œç¶å®šäº’å‹•äº‹ä»¶ã€‚(Hydration éšæ®µ)</li>
<li>æ›´æ–°å¯¦éš› DOM ç¯€é»ï¼Œå®Œæˆæ¸²æŸ“</li>
</ol>
<br/>

<p>æ›´æ–°æ¸²æŸ“</p>
<ol>
<li>ç”Ÿæˆæ–°çš„ Virtual DOM</li>
<li>å°‡æ–°çš„ Virtual DOM èˆ‡èˆŠçš„ Virtual DOM é€²è¡Œæ¯”è¼ƒï¼Œæ‰¾å‡ºéœ€è¦æ›´æ–°çš„éƒ¨åˆ† (Reconciliation éšæ®µ)</li>
<li>æ›´æ–°å¯¦éš› DOM ç¯€é»ï¼Œå®Œæˆæ¸²æŸ“ï¼Œå®Œæˆç•«é¢æ›´æ–°</li>
</ol>
<br/>
]]></content>
      <categories>
        <category>Frontend</category>
      </categories>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
  <entry>
    <title>.NET ä¸­å¦‚ä½•å¹³è¡Œç™¼é€ API</title>
    <url>/blog.github.io/2024/11/06/taskAll/</url>
    <content><![CDATA[<h2 id="æƒ…å¢ƒ"><a href="#æƒ…å¢ƒ" class="headerlink" title="æƒ…å¢ƒ"></a>æƒ…å¢ƒ</h2><p>å‡å¦‚æœ‰ä¸€å€‹ç³»çµ±éœ€è¦å®¢æˆ¶çš„æœå‹™æ­·ç¨‹ï¼Œå‰‡è³‡æ–™å¯èƒ½ç”±ä»¥ä¸‹ä¾†æºçµ„æˆï¼Œä¸¦ç”± 1 æ”¯ api å°è£å½™æ•´å¥½çš„è³‡è¨Šã€‚</p>
<ul>
<li>A: å®¢æˆ¶åŸºæœ¬è³‡æ–™</li>
<li>B: æœå‹™ç´€éŒ„æ˜ç´°</li>
<li>C: æœå‹™æ¥­å‹™è³‡è¨Š</li>
</ul>
<p>æ¯”èµ·å–å¾— A å¾Œç­‰å¾…å›æ‡‰å†å– B å†ç­‰å¾…å›æ‡‰å– Cï¼Œæ¡å¹³è¡Œæ–¹å¼ä¸€æ¬¡å– ï¼¡ã€ï¼¢ã€ï¼£ ä¸¦ç­‰å¾…ä¸€æ¬¡å›æ‡‰æ›´çœæ™‚ã€‚</p>
<p>é€ä¸€å–å¾—è³‡æ–™éœ€è¦ä¸€å€‹ç­‰ä¸€å€‹</p>
<div class="code-container" data-rel="C#"><figure class="iseeu highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> A = <span class="keyword">await</span> <span class="keyword">this</span>._aprService.GetAsync(<span class="string">&quot;/customers&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> B = <span class="keyword">await</span> <span class="keyword">this</span>._aprService.GetAsync(<span class="string">&quot;/servedRecords&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> C = <span class="keyword">await</span> <span class="keyword">this</span>._aprService.GetAsync(<span class="string">&quot;/sales&quot;</span>);</span><br></pre></td></tr></table></figure></div>

<br/>

<p>ä¸Šè¿°æƒ…å¢ƒä¸‹ï¼Œ.NET æä¾› Task.WhenAll( ) ä¾†æ”¯æ´å¹³è¡Œç™¼é€ Task ( è«‹æ±‚ &#x2F; ä»»å‹™ )</p>
<div class="code-container" data-rel="C#"><figure class="iseeu highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> task1 = Task.FromResult(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">var</span> task2 = Task.FromResult(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span>[]? results = <span class="keyword">await</span> Task.WhenAll(task1, task2);</span><br></pre></td></tr></table></figure></div>

<p>å¯¦éš›æ‡‰ç”¨ä¸­ï¼ŒTasks å›å‚³çš„çµæœé€šå¸¸å‹åˆ¥ä¸åŒï¼Œå¯ä½¿ç”¨ tuple assignment å–å¾—çµæœ</p>
<div class="code-container" data-rel="C#"><figure class="iseeu highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> apiA = <span class="keyword">this</span>._apiService.GetAsync&lt;ObjInfo&gt;(<span class="string">&quot;/api/Object&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> apiB = <span class="keyword">this</span>._apiService.GetAsync&lt;CustomerInfo&gt;(<span class="string">&quot;/api/CustomerInfo&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// results ç„¡æ³•åˆ¤æ–·å‹åˆ¥å› æ­¤æœƒéŒ¯èª¤</span></span><br><span class="line"><span class="comment">// var results = await Task.WhenAll(apiA, apiB);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">await</span> Task.WhenAll(apiA, apiB);</span><br><span class="line"><span class="keyword">var</span> (apiAResult,apiBResult) = (<span class="keyword">await</span> apiA,<span class="keyword">await</span> apiB);</span><br></pre></td></tr></table></figure></div>

<p>é™¤äº†å¸¸è¦‹çš„ WhenAllï¼Œ.NET å¦å¤–æä¾›äº† WaitAll æ–¹æ³•ã€‚</p>
<br/>

<h2 id="Task-WhenAll-Task-WaitAll-å·®ç•°åœ¨å“ª"><a href="#Task-WhenAll-Task-WaitAll-å·®ç•°åœ¨å“ª" class="headerlink" title="Task.WhenAll( ) &#x2F; Task.WaitAll( ) å·®ç•°åœ¨å“ª ?"></a>Task.WhenAll( ) &#x2F; Task.WaitAll( ) å·®ç•°åœ¨å“ª ?</h2><p>WhenAllï¼š</p>
<ul>
<li>éåŒæ­¥æ–¹æ³•ï¼Œä¸æœƒé˜»å¡åŸ·è¡Œç·’ï¼Œé©åˆç•°æ­¥ç¨‹å¼è¨­è¨ˆ</li>
</ul>
<p>WaitAllï¼š</p>
<ul>
<li>åŒæ­¥æ–¹æ³•ï¼Œæœƒé˜»å¡åŸ·è¡Œç·’ï¼Œé©åˆåŒæ­¥åŸ·è¡Œçš„å ´æ™¯</li>
</ul>
<br/>
å…¶å¯¦å…©è€…çš„å›å‚³çµæœä¹Ÿä¸åŒï¼Œä¸éï¼Œéƒ½å¯è—‰ç”± tuple assignment å–å¾—è³‡æ–™ã€‚

<br/>

<p>Tasks å›å‚³çµæœ:</p>
<div class="code-container" data-rel="C#"><figure class="iseeu highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> apiA = <span class="keyword">this</span>._apiService.GetAsync&lt;ObjInfo&gt;(<span class="string">&quot;/api/Object&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> apiB = <span class="keyword">this</span>._apiService.GetAsync&lt;CustomerInfo&gt;(<span class="string">&quot;/api/CustomerInfo&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> resultA = Task.WhenAll(apiA, apiB);</span><br><span class="line"><span class="comment">// å›å‚³å‹åˆ¥: Task?</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> resultB =  <span class="keyword">await</span> Task.WhenAll(apiA, apiB);</span><br><span class="line"><span class="comment">// å›å‚³å‹åˆ¥: éŒ¯èª¤å› ç‚º apiA,apiB çµæœä¸åŒ</span></span><br><span class="line"></span><br><span class="line">Task.WaitAll(apiA, apiB);</span><br><span class="line"><span class="comment">// å›å‚³å‹åˆ¥: void</span></span><br></pre></td></tr></table></figure></div>

<p>éƒ½å¯å–å‡º Task å„è‡ªå›å‚³çš„çµæœ:</p>
<div class="code-container" data-rel="C#"><figure class="iseeu highlight c#"><table><tr><td class="code"><pre><span class="line"> <span class="keyword">var</span> apiA = <span class="keyword">this</span>._apiService.GetAsync&lt;ObjInfo&gt;(<span class="string">&quot;/api/Object&quot;</span>);</span><br><span class="line"> <span class="keyword">var</span> apiB = <span class="keyword">this</span>._apiService.GetAsync&lt;CustomerInfo&gt;(<span class="string">&quot;/api/CustomerInfo&quot;</span>);</span><br><span class="line"></span><br><span class="line"> <span class="keyword">await</span> Task.WhenAll(apiA, apiB);</span><br><span class="line"></span><br><span class="line"> <span class="comment">// or</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">//  Task.WaitAll(apiA, apiB);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> (apiAResult,apiBResult) = (<span class="keyword">await</span> apiA,<span class="keyword">await</span> apiB);</span><br></pre></td></tr></table></figure></div>

<br/>

<h2 id="éŒ¯èª¤è™•ç†"><a href="#éŒ¯èª¤è™•ç†" class="headerlink" title="éŒ¯èª¤è™•ç†"></a>éŒ¯èª¤è™•ç†</h2><p>ç•¶ Tasks ç™¼ç”ŸéŒ¯èª¤æ™‚ï¼Œå›å‚³æ™‚æ©Ÿåˆ†ç‚º</p>
<ol>
<li>å…¨éƒ¨è™•ç†å®Œæˆå¾Œå›è¦†</li>
<li>åªè¦æœ‰ 1 å€‹éŒ¯èª¤ç™¼ç”Ÿç«‹å³å›è¦†</li>
</ol>
<br/>

<p>å…¨éƒ¨è™•ç†å®Œæˆå¾Œå›è¦† :</p>
<div class="code-container" data-rel="C#"><figure class="iseeu highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> task1 = Task.Run(() =&gt; <span class="keyword">throw</span> <span class="keyword">new</span> InvalidOperationException(<span class="string">&quot;Task 1 failed&quot;</span>));</span><br><span class="line">    <span class="keyword">var</span> task2 = Task.Run(() =&gt; <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;Task 2 failed&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// var allTasks = Task.WhenAll(task1, task2);</span></span><br><span class="line">    <span class="comment">// allTasks.Wait()</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// or</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Task.WaitAll(task1, task2);</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (AggregateException ex)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// éŒ¯èª¤é›†åˆå¯ä»¥æ•æ‰æ‰€æœ‰ Task éŒ¯èª¤</span></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="keyword">var</span> innerException <span class="keyword">in</span> ex.InnerExceptions)</span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;Exception: <span class="subst">&#123;innerException.Message&#125;</span>&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>åªè¦æœ‰ 1 å€‹éŒ¯èª¤ç™¼ç”Ÿç«‹å³å›è¦†ï¼Œå› æ­¤åªèƒ½æŠ“åˆ° 1 å€‹éŒ¯èª¤ :</p>
<div class="code-container" data-rel="C#"><figure class="iseeu highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> task1 = Task.Run(() =&gt; <span class="keyword">throw</span> <span class="keyword">new</span> InvalidOperationException(<span class="string">&quot;Task 1 failed&quot;</span>));</span><br><span class="line">    <span class="keyword">var</span> task2 = Task.Run(() =&gt; <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;Task 2 failed&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> Task.WhenAll(task1, task2);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (Exception ex)</span><br><span class="line">&#123;</span><br><span class="line">     Console.WriteLine(<span class="string">$&quot;æ•ç²åˆ°ç•°å¸¸: <span class="subst">&#123;ex.Message&#125;</span>&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<ul>
<li>WhenAll :<ul>
<li>å…¨éƒ¨è™•ç†å®Œæˆå¾Œå›è¦†</li>
<li>( æ­é…ä½¿ç”¨ await ) åªè¦æœ‰ 1 å€‹éŒ¯èª¤ç™¼ç”Ÿç«‹å‰‡å³å›è¦†</li>
</ul>
</li>
<li>WaitAll : å…¨éƒ¨è™•ç†å®Œæˆå¾Œå›è¦†<ul>
<li>å…¨éƒ¨è™•ç†å®Œæˆå¾Œå›è¦†</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>Backend</category>
      </categories>
      <tags>
        <tag>.NET</tag>
      </tags>
  </entry>
  <entry>
    <title>React Server Component</title>
    <url>/blog.github.io/2025/01/18/react-server-component/</url>
    <content><![CDATA[<h2 id="ä»€éº¼æ˜¯-React-Server-Componentï¼Ÿ"><a href="#ä»€éº¼æ˜¯-React-Server-Componentï¼Ÿ" class="headerlink" title="ä»€éº¼æ˜¯ React Server Componentï¼Ÿ"></a>ä»€éº¼æ˜¯ React Server Componentï¼Ÿ</h2><h3 id="SSR-é‹ä½œæ©Ÿåˆ¶çš„ç“¶é ¸"><a href="#SSR-é‹ä½œæ©Ÿåˆ¶çš„ç“¶é ¸" class="headerlink" title="SSR é‹ä½œæ©Ÿåˆ¶çš„ç“¶é ¸"></a>SSR é‹ä½œæ©Ÿåˆ¶çš„ç“¶é ¸</h3><p>å„˜ç®¡ SSR èƒ½å¤ è¿…é€Ÿæä¾›æ¸²æŸ“å¥½çš„ HTMLï¼Œä½†ä¹Ÿæœ‰å…¶å›°å¢ƒåœ¨ï¼š</p>
<ul>
<li>åœ¨é–‹å§‹æ¸²æŸ“é é¢ä¹‹å‰ï¼Œéœ€ç­‰å¾…é é¢è³‡æ–™åŠ è¼‰å®Œæˆ</li>
<li>æ•´é  Hydration éšæ®µå®Œæˆå‰ï¼Œå®¢æˆ¶ç«¯ä¸èƒ½èˆ‡é é¢äº’å‹•</li>
<li>æ•´é éƒ½éœ€è¦ Hydrate ä¸”éœ€å°‡ JavaScript éƒ½è¼‰åˆ°å®¢æˆ¶ç«¯æ‰èƒ½é€²è¡Œ</li>
</ul>
<br/>

<p>é é¢è³‡æ–™åŠ è¼‰é˜»å¡æ¸²æŸ“çš„ç¯„ä¾‹ ( ä»¥ä¸‹ç¯„ä¾‹çš†ä»¥ Next.Js ç‚ºä¸» )</p>
<div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Home Page é é¢</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Home</span> = (<span class="params">&#123; data &#125;</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">ComponentA</span> <span class="attr">data</span>=<span class="string">&#123;data&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">ComponentB</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getServerSideProps</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// åªæœ‰ ComponentA éœ€è¦ dataï¼ŒComponentB ä¹Ÿéœ€è¦è·Ÿè‘—ç­‰å¾…</span></span><br><span class="line">  <span class="keyword">const</span> data = <span class="keyword">await</span> <span class="title function_">getComponentAData</span>();</span><br><span class="line">  <span class="keyword">return</span> &#123;<span class="attr">props</span>:&#123; data &#125;&#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>

<br>

<blockquote>
<p><b>Hydration éšæ®µ</b><br>æ¸²æŸ“ç”¢ç”Ÿçš„ HTML æ˜¯éœæ…‹çš„ï¼Œè‹¥è¦å…·å‚™äº’å‹•æ€§ï¼ˆä¾‹å¦‚ï¼šæŒ‰éˆ•å¯æŒ‰ä¸‹ä¸¦è§¸ç™¼äº‹ä»¶ï¼‰éœ€è¦ç¶“é Hydration éšæ®µã€‚<br>æ„æ€æ˜¯è¼‰å…¥ JavaScript å°‡ React ç‹€æ…‹èˆ‡ DOM çš„ç›£è½äº‹ä»¶ç¶å®šï¼Œæ‰èƒ½å…·æœ‰äº’å‹•æ€§ã€‚</p>
</blockquote>
<br>

<h3 id="Suspense-å…ƒä»¶å»¶é²æ¸²æŸ“"><a href="#Suspense-å…ƒä»¶å»¶é²æ¸²æŸ“" class="headerlink" title="Suspense å…ƒä»¶å»¶é²æ¸²æŸ“"></a>Suspense å…ƒä»¶å»¶é²æ¸²æŸ“</h3><p>ç‚ºè§£æ±º SSR æ•´é å¼æ¸²æŸ“çš„é‹ä½œæ©Ÿåˆ¶ï¼ŒReact æå‡ºå…è¨±å»¶é²æ¸²æŸ“çš„ Suspense å…ƒä»¶ï¼Œæ ¸å¿ƒæ¦‚å¿µï¼š</p>
<ul>
<li>ä¼ºæœå™¨å„ªå…ˆæ¸²æŸ“é Suspense å€å¡Šä¸¦åˆ†æ‰¹ç™¼çµ¦å®¢æˆ¶ç«¯ï¼Œä¸å¿…ç­‰å¾…æ•´é ä¸€æ¬¡æ€§å›è¦†(ä¸²æµå¼æ¸²æŸ“)</li>
<li>å‹•æ…‹èª¿æ•´æ¸²æŸ“å„ªå…ˆç´šï¼Œé è¨­é †åºè¼ƒå¾Œçš„å…ƒä»¶è‹¥è¢«å®¢æˆ¶ç«¯æŒ‰ä¸‹å¾Œå°‡æå‰æ¸²æŸ“</li>
</ul>
<p>ç¯„ä¾‹ä¸­ ComponentB å°‡å„ªå…ˆå›å‚³ï¼ŒComponentA å‰‡å¯ä»¥å»¶é²æ¸²æŸ“å¾Œå›å‚³çµ¦å®¢æˆ¶ç«¯ :</p>
<div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Home Page é é¢</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Home</span> = (<span class="params">&#123; data &#125;</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Suspense</span> <span class="attr">fallback</span>=<span class="string">&#123;</span>&lt;<span class="attr">div</span>&gt;</span>Loading Component A...<span class="tag">&lt;/<span class="name">div</span>&gt;</span>&#125;&gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ComponentA</span> <span class="attr">data</span>=<span class="string">&#123;data&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Suspense</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">ComponentB</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getServerSideProps</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> data = <span class="keyword">await</span> <span class="title function_">getComponentAData</span>();</span><br><span class="line">  <span class="keyword">return</span> &#123;<span class="attr">props</span>:&#123; data &#125;&#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>

<br>

<p>å³ä¾¿æå‡ºäº†å»¶é²å€å¡Šæ¸²æŸ“çš„å„ªåŒ–æ–¹æ¡ˆï¼Œæ ¸å¿ƒå•é¡Œä»ç„¶å­˜åœ¨ã€‚<br>å› æ­¤ï¼Œæ‰æœ‰äº†ä»Šå¤©çš„ä¸»è§’ React Server Componentï¼ˆor RSC)ã€‚</p>
<h3 id="React-Server-Component-RSC"><a href="#React-Server-Component-RSC" class="headerlink" title="React Server Component ( RSC )"></a>React Server Component ( RSC )</h3><p>RSC ä¸¦ä¸æ˜¯ç‚ºäº†å–ä»£ SSR æˆ– Suspenseï¼Œè€Œæ˜¯æ”¹è®Šäº† SSR çš„é‹ä½œæ©Ÿåˆ¶ã€‚<br/><br>ä¸€èˆ¬ä¾†èªªï¼Œå®Œæ•´çš„æ‡‰ç”¨ç¨‹å¼é™¤äº† RSC é‚„æœƒæœ‰ Client Component (or RCC)ã€‚</p>
<h4 id="RSC-ç‰¹é»"><a href="#RSC-ç‰¹é»" class="headerlink" title="RSC ç‰¹é»"></a>RSC ç‰¹é»</h4><ul>
<li>å°‡ åŠ è¼‰è³‡æ–™ èˆ‡ æ¸²æŸ“ åœ¨ä¼ºæœå™¨ç«¯ä»¥ã€Œå…ƒä»¶ã€ç‚ºå–®ä½è™•ç†</li>
<li>ä¸²æµæ–¹å¼å›å‚³çµ¦å®¢æˆ¶ç«¯</li>
<li>æ¸›å°‘ä¼ºæœå™¨éœ€æ‰“åŒ…ä¸¦å‚³è¼¸çµ¦å®¢æˆ¶ç«¯çš„ JavaScript</li>
</ul>
<br/>

<p>RSC æœ‰åˆ¥æ–¼ SSRï¼Œä¼ºæœå™¨æ¥å—åˆ°é é¢è«‹æ±‚å¾Œæ˜¯ä»¥ã€Œå…ƒä»¶ã€ç‚ºå–®ä½é©…å‹•è™•ç†çš„ï¼Œæ‰€ä»¥ä¸æœƒæœ‰é é¢ä¸‹ A å…ƒä»¶éœ€è¦ A è³‡æ–™ï¼ŒB å…ƒä»¶ä¸éœ€è¦å»å¾—ç­‰ A è³‡æ–™åŠ è¼‰å®Œæˆæ‰èƒ½æ¸²æŸ“çš„å•é¡Œã€‚RSC å¾—ä»¥è®“ A å…ƒä»¶å– A è³‡æ–™ï¼ŒB å…ƒä»¶åŒæ™‚æ¸²æŸ“è‡ªå·±çš„å…§å®¹ï¼Œå…©è€…å¹³è¡Œè™•ç†ã€‚</p>
<p>é é¢ä¸‹ä¸­çš„ RSC èˆ‡ RCCï¼Œä¸å¿…ç­‰å¾…å…¨æ•¸æ¸²æŸ“å®Œæˆæ‰å›å‚³ï¼Œå„ªå…ˆå®Œæˆçš„éƒ¨åˆ†å°‡åˆ†æ‰¹å›å‚³çµ¦å®¢æˆ¶ç«¯ï¼Œè®“åˆæ¬¡è¼‰å…¥é€Ÿåº¦æ›´å¿«ä½¿ç”¨è€…é«”é©—æ›´ä½³ï¼Œä¸”ä¸²æµå¼æ¸²æŸ“çš„ SEO åœ¨ç¾ä»£ç€è¦½å™¨ä¸­èƒ½å¤ è¢«çˆ¬èŸ²è­˜åˆ¥ã€‚</p>
<p>ç”±æ–¼ RSC åœ¨ä¼ºæœå™¨å°±æ¸²æŸ“æˆéœæ…‹ HTMLï¼Œæœ¬èº«åˆä¸åŒ…å«å®¢æˆ¶ç«¯æ“ä½œé‚è¼¯ï¼Œå› æ­¤ç›¸æ¯” SSR è¦æ‰“åŒ…äº¤çµ¦å®¢æˆ¶ç«¯è™•ç†çš„ JavaScript æ¸›å°‘äº†ä¸” RSC ä¸å¿… Hydrateã€‚</p>
<h4 id="RCC-ç‰¹é»"><a href="#RCC-ç‰¹é»" class="headerlink" title="RCC ç‰¹é»"></a>RCC ç‰¹é»</h4><ul>
<li>è™•ç†å®¢æˆ¶ç«¯æ“ä½œé‚è¼¯</li>
<li>å®¢æˆ¶ç«¯åŒ…å« Hydration éšæ®µ</li>
</ul>
<p>RCC ä¸»è¦è™•ç†å®¢æˆ¶ç«¯çš„æ“ä½œé‚è¼¯ï¼Œé‹ä½œæ–¹å¼å¦‚åŒ SSRï¼Œä¼ºæœå™¨æ¸²æŸ“å¾Œçš„çµæœåŒ…å«: HTMLã€JavaScriptï¼Œå†äº¤å®¢æˆ¶ç«¯ Hydrateã€‚</p>
<p>ä»¥ RSC èˆ‡ RCC çµ„æˆé é¢</p>
<div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ComponentA.js = React Server Component (RSC)</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">ComponentA</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> data = <span class="keyword">await</span> <span class="title function_">fetchComponentAData</span>();</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Component A<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;data&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ComponentB.js = React Client Component (RCC)</span></span><br><span class="line"><span class="string">&quot;use client&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">ComponentB</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleClick</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">setCount</span>(count + <span class="number">1</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleClick&#125;</span>&gt;</span>Click me<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>Button clicked &#123;count&#125; times<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Home Page é é¢</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Page</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">ComponentA</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">ComponentB</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>

<br/>

<p>å‡å¦‚ ComponentA åŠ è¼‰è³‡æ–™(fetchComponentAData)éç¨‹å¾ˆæ…¢ï¼ŒComponentB ä¹Ÿèƒ½å…ˆæ¸²æŸ“ä¸¦å›å‚³çµ¦å®¢æˆ¶ç«¯é€²è¡Œ Hydrateï¼Œæ–¼æ­¤åŒæ™‚ï¼Œ ComponentA ç¹¼çºŒç›´åˆ°å®Œæˆå¾Œå†å›å‚³ã€‚</p>
<h4 id="RSC-RCC-ä¸‹-Suspense-çš„è·è²¬"><a href="#RSC-RCC-ä¸‹-Suspense-çš„è·è²¬" class="headerlink" title="RSC&#x2F;RCC ä¸‹ Suspense çš„è·è²¬"></a>RSC&#x2F;RCC ä¸‹ Suspense çš„è·è²¬</h4><ul>
<li>SSR: Suspense æ˜¯å¯¦ç¾ä¸²æµæ¸²æŸ“çš„å¿…è¦å…ƒä»¶ï¼Œé…ç½®æ‰èƒ½å»¶é²æ¸²æŸ“ã€‚</li>
<li>RSC&#x2F;RCC: å…ƒä»¶æœ¬èº«å·²æ”¯æŒä¸²æµæ¸²æŸ“ï¼Œå› æ­¤ Suspense è·è²¬è‘—é‡åœ¨ç‚ºæ…¢é€Ÿã€æ¬¡è¦å…ƒä»¶æº–å‚™ fallback UIã€‚</li>
</ul>
<h4 id="é‹ä½œæµç¨‹"><a href="#é‹ä½œæµç¨‹" class="headerlink" title="é‹ä½œæµç¨‹"></a>é‹ä½œæµç¨‹</h4><div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">Page</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> pageData = <span class="keyword">await</span> <span class="title function_">getPageData</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;pageData.title&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      &#123;/* RSC */&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Suspense</span> <span class="attr">fallback</span>=<span class="string">&#123;</span>&lt;<span class="attr">Loading</span> /&gt;</span>&#125;&gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ServerComponent</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Suspense</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">       &#123;/* RCC */&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">ClientComponentB</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>

<p>å†æ¬¡å¼·èª¿ï¼ŒSSR æŒ‡çš„æ˜¯ä¼ºæœå™¨ç«¯çš„æ¸²æŸ“ï¼Œè€Œ RSC çš„å‡ºç¾æ”¹å–„äº† SSR çš„é‹ä½œæ©Ÿåˆ¶ï¼Œä¸¦ä¸æ˜¯å–ä»£ SSR.</p>
<p>èªªæ˜</p>
<ol>
<li>Page ç‚ºé é¢å±¤ç´šçš„å…ƒä»¶ï¼Œå› æ­¤éœ€ç­‰å¾… pageData å¾Œæ‰èƒ½æ¥çºŒæ¸²æŸ“</li>
<li>ä½µè¡Œæ¸²æŸ“ Page å…§éƒ¨çš„å…§å®¹ï¼Œè‹¥ RSC&#x2F;RCC åŒ…å«åŠ è¼‰è³‡æ–™å‰‡åˆ†åˆ¥è™•ç†</li>
<li>h1ã€Suspense å…ˆå›å‚³çµ¦å®¢æˆ¶ç«¯é é¢</li>
<li>åŒæ™‚ ServerComponentã€ClientComponentB ç¹¼çºŒæ¸²æŸ“ç›´åˆ°å®Œæˆå†çµ¦å®¢æˆ¶ç«¯</li>
<li>åƒ… ClientComponentB åœ¨å®¢æˆ¶ç«¯éœ€è¦ Hydrate</li>
<li>å®Œæˆé é¢æ¸²æŸ“</li>
</ol>
]]></content>
      <categories>
        <category>Frontend</category>
      </categories>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
</search>
